{"version":3,"sources":["validate.js"],"names":["forms","document","querySelectorAll","forEach","e","addEventListener","event","preventDefault","thisForm","action","getAttribute","recaptcha","displayError","querySelector","classList","add","remove","formData","FormData","grecaptcha","ready","execute","then","token","set","php_email_form_submit","error","fetch","method","body","headers","response","ok","text","Error","status","statusText","url","data","trim","reset"],"mappings":"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","sourcesContent":["/**\r\n* PHP Email Form Validation - v3.6\r\n*/\r\n(function () {\r\n  \"use strict\";\r\n\r\n  let forms = document.querySelectorAll('.php-email-form');\r\n\r\n  forms.forEach( function(e) {\r\n    e.addEventListener('submit', function(event) {\r\n      event.preventDefault();\r\n\r\n      let thisForm = this;\r\n\r\n      let action = thisForm.getAttribute('action');\r\n      let recaptcha = thisForm.getAttribute('data-recaptcha-site-key');\r\n      \r\n      if( ! action ) {\r\n        displayError(thisForm, 'The form action property is not set!');\r\n        return;\r\n      }\r\n      thisForm.querySelector('.loading').classList.add('d-block');\r\n      thisForm.querySelector('.error-message').classList.remove('d-block');\r\n      thisForm.querySelector('.sent-message').classList.remove('d-block');\r\n\r\n      let formData = new FormData( thisForm );\r\n\r\n      if ( recaptcha ) {\r\n        if(typeof grecaptcha !== \"undefined\" ) {\r\n          grecaptcha.ready(function() {\r\n            try {\r\n              grecaptcha.execute(recaptcha, {action: 'php_email_form_submit'})\r\n              .then(token => {\r\n                formData.set('recaptcha-response', token);\r\n                php_email_form_submit(thisForm, action, formData);\r\n              })\r\n            } catch(error) {\r\n              displayError(thisForm, error);\r\n            }\r\n          });\r\n        } else {\r\n          displayError(thisForm, 'The reCaptcha javascript API url is not loaded!')\r\n        }\r\n      } else {\r\n        php_email_form_submit(thisForm, action, formData);\r\n      }\r\n    });\r\n  });\r\n\r\n  function php_email_form_submit(thisForm, action, formData) {\r\n    fetch(action, {\r\n      method: 'POST',\r\n      body: formData,\r\n      headers: {'X-Requested-With': 'XMLHttpRequest'}\r\n    })\r\n    .then(response => {\r\n      if( response.ok ) {\r\n        return response.text();\r\n      } else {\r\n        throw new Error(`${response.status} ${response.statusText} ${response.url}`); \r\n      }\r\n    })\r\n    .then(data => {\r\n      thisForm.querySelector('.loading').classList.remove('d-block');\r\n      if (data.trim() == 'OK') {\r\n        thisForm.querySelector('.sent-message').classList.add('d-block');\r\n        thisForm.reset(); \r\n      } else {\r\n        throw new Error(data ? data : 'Form submission failed and no error message returned from: ' + action); \r\n      }\r\n    })\r\n    .catch((error) => {\r\n      displayError(thisForm, error);\r\n    });\r\n  }\r\n\r\n  // function displayError(thisForm, error) {\r\n  //   thisForm.querySelector('.loading').classList.remove('d-block');\r\n  //   thisForm.querySelector('.error-message').innerHTML = error;\r\n  //   thisForm.querySelector('.error-message').classList.add('d-block');\r\n  // }\r\n\r\n})();\r\n"],"file":"validate.dev.js"}