{"version":3,"sources":["validate.js"],"names":["php_email_form_submit","thisForm","action","formData","fetch","method","body","headers","X-Requested-With","then","response","ok","text","Error","concat","status","statusText","url","querySelector","classList","remove","data","trim","add","error","displayError","document","querySelectorAll","forms","event","addEventListener","this","recaptcha","getAttribute","FormData","grecaptcha","ready","execute","set","token"],"mappings":"cAGA,WA8CE,SAASA,EAAsBC,EAAUC,EAAQC,GAC/CC,MAAMF,EAAQ,CACZG,OAAQ,OACRC,KAAMH,EACNI,QAAS,CAAAC,mBAAA,oBAAAC,KAAA,SAAAC,GAHX,GAKCD,EAAKE,GACJ,OAAID,EAAcE,OAAlB,MAEO,IAAAC,MAAA,GAAAC,OAAAJ,EAAAK,OAAA,KAAAD,OAAAJ,EAAAM,WAAA,KAAAF,OAAAJ,EAAAO,QARTR,KAYCA,SAAAA,GAEC,GADAR,EAASiB,cAAc,YAAYC,UAAUC,OAAO,WACjC,MAAfC,EAAKC,OAAT,MAGO,IAAAT,MAAAQ,GAAA,8DAAAnB,GAHPD,EAASqB,cAAgB,iBAAAH,UAAAI,IAAA,WACvBtB,EAASiB,UAfbd,MAAA,SAAAoB,GAsBEC,aAAaxB,EAAUuB,KApE3BE,SAAAC,iBAAA,mBAEIC,QAAQF,SAASC,GAErBC,EAAAA,iBAAe,SAAY,SAAAC,GACvBC,EAAAA,iBAGA,IAAI7B,EAAW8B,KAGXC,EAAS/B,EAAGA,aAASgC,UAArBD,EAAY/B,EAASgC,aAAa,2BAGpCR,GAAAA,EAAAA,CAGFxB,EAASiB,cAAc,YAAYC,UAAUI,IAAI,WACjDtB,EAASiB,cAAc,kBAAkBC,UAAUC,OAAO,WAC1DnB,EAASiB,cAAc,iBAAiBC,UAAUC,OAAO,WAEzD,IAAIjB,EAAW,IAAI+B,SAAUjC,GAG3B+B,EACmB,oBAAjBG,WACEA,WAAIC,MAAA,WACFD,IAA+BjC,WAAQmC,QAAAL,EAAA,CAAA9B,OAAA,0BAAvCO,KACCA,SAAAA,GACCN,EAASmC,IAAI,qBAAsBC,GACnCvC,EAAsBC,EAAUC,EAAQC,KAE1C,MAAAqB,GACAC,aAAaxB,EAAUuB,MAI3BC,aAAaxB,EAAU,mDAGzBD,EAAsBC,EAAUC,EAAQC,QAzBxCsB,aAAAxB,EAAA,4CAhBR","file":"validate.min.js","sourcesContent":["/**\r\n* PHP Email Form Validation - v3.6\r\n*/\r\n(function () {\r\n  \"use strict\";\r\n\r\n  let forms = document.querySelectorAll('.php-email-form');\r\n\r\n  forms.forEach( function(e) {\r\n    e.addEventListener('submit', function(event) {\r\n      event.preventDefault();\r\n\r\n      let thisForm = this;\r\n\r\n      let action = thisForm.getAttribute('action');\r\n      let recaptcha = thisForm.getAttribute('data-recaptcha-site-key');\r\n      \r\n      if( ! action ) {\r\n        displayError(thisForm, 'The form action property is not set!');\r\n        return;\r\n      }\r\n      thisForm.querySelector('.loading').classList.add('d-block');\r\n      thisForm.querySelector('.error-message').classList.remove('d-block');\r\n      thisForm.querySelector('.sent-message').classList.remove('d-block');\r\n\r\n      let formData = new FormData( thisForm );\r\n\r\n      if ( recaptcha ) {\r\n        if(typeof grecaptcha !== \"undefined\" ) {\r\n          grecaptcha.ready(function() {\r\n            try {\r\n              grecaptcha.execute(recaptcha, {action: 'php_email_form_submit'})\r\n              .then(token => {\r\n                formData.set('recaptcha-response', token);\r\n                php_email_form_submit(thisForm, action, formData);\r\n              })\r\n            } catch(error) {\r\n              displayError(thisForm, error);\r\n            }\r\n          });\r\n        } else {\r\n          displayError(thisForm, 'The reCaptcha javascript API url is not loaded!')\r\n        }\r\n      } else {\r\n        php_email_form_submit(thisForm, action, formData);\r\n      }\r\n    });\r\n  });\r\n\r\n  function php_email_form_submit(thisForm, action, formData) {\r\n    fetch(action, {\r\n      method: 'POST',\r\n      body: formData,\r\n      headers: {'X-Requested-With': 'XMLHttpRequest'}\r\n    })\r\n    .then(response => {\r\n      if( response.ok ) {\r\n        return response.text();\r\n      } else {\r\n        throw new Error(`${response.status} ${response.statusText} ${response.url}`); \r\n      }\r\n    })\r\n    .then(data => {\r\n      thisForm.querySelector('.loading').classList.remove('d-block');\r\n      if (data.trim() == 'OK') {\r\n        thisForm.querySelector('.sent-message').classList.add('d-block');\r\n        thisForm.reset(); \r\n      } else {\r\n        throw new Error(data ? data : 'Form submission failed and no error message returned from: ' + action); \r\n      }\r\n    })\r\n    .catch((error) => {\r\n      displayError(thisForm, error);\r\n    });\r\n  }\r\n\r\n  // function displayError(thisForm, error) {\r\n  //   thisForm.querySelector('.loading').classList.remove('d-block');\r\n  //   thisForm.querySelector('.error-message').innerHTML = error;\r\n  //   thisForm.querySelector('.error-message').classList.add('d-block');\r\n  // }\r\n\r\n})();\r\n"]}